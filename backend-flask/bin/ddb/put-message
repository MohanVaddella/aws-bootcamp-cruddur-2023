#!/usr/bin/env python3

import boto3
import sys
from datetime import datetime

attrs = {
  'endpoint_url': 'http://localhost:8000'
}

if len(sys.argv) == 2:
  if "prod" in sys.argv[1]:
    attrs = {}

dynamodb = boto3.client('dynamodb',**attrs)
table_name = 'cruddur-messages'

timestamp = datetime.now().isoformat()

# Entity # Message Group Id
record = {
  'pk':   {'S': 'MSG#1'},
  'sk':   {'S': timestamp },
  'data': {'S': 'How are you doing'},
  'sender_uuid': {'S': '25b0a907-2e7d-426b-b260-e56ee279ea14'},
  'sender_display_name': {'S': 'Andrew Brown'},
  'sender_handle': {'S': 'andrewbrown'}
}

# insert the record into the table
response = dynamodb.put_item(
  TableName=table_name,
  Item=record
)

# print the response
print(response)