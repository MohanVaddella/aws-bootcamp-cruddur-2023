#!/usr/bin/env python3

import boto3
import sys
import json


attrs = {
  'endpoint_url': 'http://localhost:8000'
}

if len(sys.argv) == 2:
  if "prod" in sys.argv[1]:
    attrs = {}

dynamodb = boto3.client('dynamodb',**attrs)
table_name = 'cruddur-messages'

brown_user_uuid = "2aa1c49c-669a-47b0-9177-37efe9e420c4"

# define the query parameters
query_params = {
  'TableName': table_name,
  "IndexName": 'data-sk-index',
  'KeyConditionExpression': 'data = :my_user_uuid',
  'ExpressionAttributeValues': {
    ':my_user_uuid': {'S': brown_user_uuid}
  }
}

# query the table
response = dynamodb.query(**query_params)

# print the items returned by the query
items = response['Items']
print(json.dumps(items, sort_keys=True, indent=2))